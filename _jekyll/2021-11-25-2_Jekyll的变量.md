---
layout: post
title: 2 Jekyll的变量
date: 2021-11-25 11:31:00 +0800
category: document
thumbnail: /assets/images/thumbnail/twilight_sparkle.png
icon: book
excerpt: 通过变量对博客“编程”
---

* Content
{:toc}

## 前言

本篇介绍 Jekyll 中的部分变量，并尝试用这些变量来设置我们博客的信息，最后将这些变量显示出来。

阅读本篇文章，你需要的预备知识有：

- 对编程中，“变量”这一概念的理解
- 曾经使用过其他 Jekyll 主题

## 变量

Jekyll 通过 [Liquid](https://liquid.bootcss.com/) 模板语言生成一系列数据，存储在一系列变量中。这些变量会在生成静态页面的过程中替换为实际的值。

实际上，在上一节中，`{{ content }}` 中的 `content` 就是一个变量。

## 变量概览

Jekyll 中有预设的变量有如下这些。当然，你不需要记，我列出来只是为了方便以后查找。

### 全局变量

|变量|说明|
|---|----|
|`site`|全局范围的信息+`_config.yml` 中的信息|
|`page`|页面专属的信息 + YAML 头信息|
|`layout`|布局专属的信息 + 布局的 YAML 头信息|
|`content`|被 layout 包裹的那些 Post 或者 Page 渲染生成的内容。|
|`paginator`|每当 paginate 配置选项被设置了的时候，这个变量就可用了。详情请看[分页](http://jekyllcn.com/docs/pagination/)。 |

### site 变量

|变量|说明|
|---|----|
|`site.time`|运行jekyll时的时间|
|`site.pages`|所有 pages 的列表|
|`site.posts`|按时间倒序的所有 posts 列表|
|`site.related_posts`|
|`site.static_files`|静态文件列表
|`site.html_pages`|`site.pages` 的子集，存储以 .html 结尾的部分。 
|`site.html_files`|`site.static_files` 的子集，存储以 .html 结尾的部分。
|`site.collections`|一个所有集合（collection）的清单。 
|`site.data`|一个存储了 `_data` 目录下的YAML文件数据的清单。 |
|`site.documents`|每一个集合（collection）中的全部文件的清单。 |
|`site.categories.CATEGORY`|所有的在 CATEGORY 类别下的帖子。|
|`site.tags.TAG`|所有的在 TAG 标签下的帖子。|
|`site.[CONFIGURATION_DATA]`|所有的通过命令行和 `_config.yml` 设置的变量都会存到这个 site 里面。|



### page 变量

|变量|说明|
|---|---|
|`page.content`|页面内容的源码|
|`page.title`|页面的标题|
|`page.excerpt`|页面摘要的源码|
|`page.url`|帖子以斜线打头的相对路径，例子： /2008/12/14/my-post.html|
|`page.date`|帖子的日期|
|`page.id`|帖子的唯一标识码（在RSS源里非常有用），比如 /2008/12/14/my-post|
|`page.categories`|
|`page.tags`|这个 Post 所属的所有 tags|
|`page.path`|Post 或者 Page 的源文件地址。举例来说，一个页面在 GitHub 上的源文件地址。|
|`page.next`|当前文章在 `site.posts` 中的位置对应的下一篇文章。若当前文章为最后一篇文章，返回 `nil`
|`page.previous`|当前文章在`site.posts` 中的位置对应的上一篇文章。若当前文章为第一篇文章，返回 `nil`|

### paginator 变量

|变量|说明|
|----|----|
|`paginator.page`|当前页码|
|`paginator.per_page`|每一页的页码|
|`paginator.posts`|当前页可用的 posts|
|`paginator.total_posts`|posts 的总数。
|`paginator.total_pages`|pages 的总数|
|`paginator.previous_page`|上一页的页码，若无，则为`nil`|
|`paginator.previous_page_path`|上一页的地址，若无，则为`nil`|
|`paginator.next_page`|下一页的页码，若无，则为`nil`|
|`paginator.next_page_path`|下一页的地址，若无，则为`nil`|

注意，`paginator` 变量只能在 index 文件中使用，但 index 文件可以位于子目录，比如 `/blog/index.html`

## 使用变量

下面我们用一个简单的例子来示范怎么使用变量。在上一节中，我们写了一个简单的 index.html 和 一篇博文。下面我们将所写的博文展示在 index.html 中，方便读者访问（毕竟读者博文的不知道网址呀）

最简单的展示方法就是列表。我们可以在 index.html 中这样写：

```html
<p>以下是我的博文：</p>

<ul>
    <li><a href="/2021/11/24/hello-world">hello-world</a></li>
</ul>
```

但是这样的话，每多写一篇博文，就要改一次，很不方便。所以我们用变量来代替：

{% raw %}
<p>以下是我的博文：</p>

<ul>
    {% for post in site.posts %}
    <li><a href="{{ post.url }}">{{ post.title }}</a></li>
    {% endfor %}
</ul>
{% endraw %}

这里我们通过 Liquid 中的 for，对博客中的每篇博文都生成一个列表项，链接为 `post.url`，链接的文字为 `post.title`。

如果你直接将这个push上去，你会发现什么都没有。因为我们需要加一个头信息，Jekyll 才会处理这个文件。所以完整的 indexl.html 应该是：

{% raw %}
---
---

<p>以下是我的博文：</p>

<ul>
    {% for post in site.posts %}
    <li><a href="{{ post.url }}">{{ post.title }}</a></li>
    {% endfor %}
</ul>
{% endraw %}