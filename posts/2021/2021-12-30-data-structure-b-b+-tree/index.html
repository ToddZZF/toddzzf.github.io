<!doctype html><html><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=pragma content="no-cache"><meta http-equiv=cache-control content="no-cache"><meta http-equiv=expires content="0"><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/lxgw-wenkai-lite-webfont@1.7.0/style.css><link rel=stylesheet href=/css/tailwindcss/output.css><link rel=stylesheet href=/css/mdstyle.css><script defer src=https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js></script>
<link href=https://cdn.bootcdn.net/ajax/libs/highlight.js/11.4.0/styles/github-dark-dimmed.min.css rel=stylesheet><script id=highlightjs src=https://cdn.bootcdn.net/ajax/libs/highlight.js/11.4.0/highlight.min.js async></script>
<script>document.getElementById("highlightjs").addEventListener("load",function(){hljs.highlightAll()})</script><title>数据结构：B&amp;B+树 - Todd's Blog</title></head><body class="font-kai bg-neutral-50 antialiased"><header class="w-full text-gray-700 bg-white dark-mode:text-gray-200 dark-mode:bg-gray-800 shadow-sm"><div x-data="{ open: false }" class="flex flex-col max-w-screen-xl px-4 mx-auto md:items-center md:justify-between md:flex-row md:px-6 lg:px-8"><div class="p-4 flex flex-row items-center justify-between"><a href=/ class="text-lg tracking-wider text-gray-900 uppercase rounded-lg dark-mode:text-white">Todd's Blog</a>
<button class="md:hidden rounded-lg focus:outline-none focus:drop-shadow-sm" @click="open = !open"><svg fill="currentcolor" viewBox="0 0 20 20" class="w-6 h-6"><path x-show="!open" fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4A1 1 0 013 5zm0 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm6 5a1 1 0 011-1h6a1 1 0 110 2h-6a1 1 0 01-1-1z" clip-rule="evenodd"/><path x-show="open" fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414.0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"/></svg></button></div><nav :class="{'flex': open, 'hidden': !open}" class="flex-col flex-grow pb-4 md:pb-0 hidden md:flex md:justify-end md:flex-row"><a class="px-4 py-2 mt-2 text-sm font-semibold text-gray-900 rounded-lg dark-mode:bg-gray-700 dark-mode:hover:bg-gray-600 dark-mode:focus:bg-gray-600 dark-mode:focus:text-white dark-mode:hover:text-white dark-mode:text-gray-200 md:mt-0 hover:text-gray-900 focus:text-gray-900 hover:bg-gray-200 focus:bg-gray-200 focus:outline-none focus:shadow-outline" href=/goodstuffs/>好物</a>
<a class="px-4 py-2 mt-2 text-sm font-semibold text-gray-900 rounded-lg dark-mode:bg-gray-700 dark-mode:hover:bg-gray-600 dark-mode:focus:bg-gray-600 dark-mode:focus:text-white dark-mode:hover:text-white dark-mode:text-gray-200 md:mt-0 hover:text-gray-900 focus:text-gray-900 hover:bg-gray-200 focus:bg-gray-200 focus:outline-none focus:shadow-outline" href=/posts/>日常</a></nav></div></header><main><div class="max-w-screen-lg w-full mx-auto py-8 px-4 flex flex-col gap-4"><div class="breadcrumb w-full bg-white py-2 px-4 shadow-sm"><ul class="flex align-baseline flex-wrap"><li class="after:content-['>'] after:mr-0.5 after:text-gray-300 whitespace-nowrap"><a href=http://example.org/>主页</a></li><li class="after:content-['>'] after:mr-0.5 after:text-gray-300 whitespace-nowrap"><a href=http://example.org/posts/>日常</a></li><li class="active whitespace-nowrap"><a href=http://example.org/posts/2021/2021-12-30-data-structure-b-b+-tree/>数据结构：B&amp;B+树</a></li></ul></div><div class="w-full mx-auto py-8"><div class="text-4xl font-semibold">数据结构：B&amp;B+树</div><div class="flex gap-2 text-sm flex-wrap"><span class=post-date>2021-12-30</span>
<a href=/posts/>📂日常</a></div></div><div class="mdstyle highlightjs"><h2 id=b树>B树</h2><h3 id=基本概念>基本概念</h3><p>B树中，结点中的孩子结点个数的最大值为B树的<strong>阶 m</strong>，并满足如下一些性质：</p><ol><li><p>每个结点最多有 $m$ 个子树，最少有 $\lceil m/2 \rceil$ 个分支。特殊的，根结点若不是叶子，则最少有 2 个分支</p></li><li><p>若一个结点有 $n-1$ 个关键字，则有 $n$ 个分支。且关键字递增排列。关键字和孩子结点的关系如下：</p><pre tabindex=0><code>  k1  k2  k3  ...  kn
 /  |   |   |        \
p0  p1  p2  p3  ...  pn
</code></pre><p>其中，$n$ 为关键字的个数，ki 为关键字且满足ki&lt;ki+1，pi为孩子结点的指针且所指结点的关键字满足 ki&lt;pi&lt;ki+1</p></li><li><p>根据1和2，可知结点最多有 $m-1$ 个关键字，最少有 $\lceil m/2 \rceil-1$ 个关键字。（特殊的，根可以只有1个关键字）</p></li><li><p>叶子结点处于同一层，可以用空指针表示，是查找失败到达的位置。（也就是叶子结点全都是空结点）</p></li><li><p>（根据上一条）B树是平衡的</p></li></ol><h3 id=b树的查找>B树的查找</h3><p>从根结点出发，</p><ol><li>先查找结点内的关键字</li><li>若找不到，则在对应范围内查找</li></ol><h3 id=b树的插入>B树的插入</h3><ol><li>定位：找到最低层中的某个非叶结点</li><li>插入：若插入后，关键字个数大于 $m-1$（即子树大于 $m$），则分裂，否则完成插入。</li><li>分裂：以 $\lceil m \rceil$ 关键字进行划分，分为两个子结点，然后中间 $\lceil m \rceil$ 关键字则插入到父结点。若父节点超出 $m-1$，则继续分裂。</li></ol><p>这个和2-3树是类似的。</p><h3 id=b树的建立>B树的建立</h3><ol><li>首先确定树的阶数</li><li>先经可能地将根填满到 $m-1$</li><li>然后不断地插入</li></ol><p>示例：5阶树</p><pre tabindex=0><code>{1,2,6,7,11,4,8,13,10,5,17,9,16,20,3,12,14,18,19,15}
</code></pre><pre tabindex=0><code>{11,4,8,13,10,5,17,9,16,20,3,12,14,18,19,15}

1,2,6,7
</code></pre><pre tabindex=0><code>{4,8,13,10,5,17,9,16,20,3,12,14,18,19,15}

   6
  /  \
1,2  7,11
</code></pre><pre tabindex=0><code>{10,5,17,9,16,20,3,12,14,18,19,15}

     6
   /   \
1,2,4  7,8,11,13
</code></pre><pre tabindex=0><code>{5,17,9,16,20,3,12,14,18,19,15}

     6, 10
   /   \   \
1,2,4  7,8  11,13
</code></pre><pre tabindex=0><code>{20,3,12,14,18,19,15}

     6,  10
   /   \      \
1,2,4,5  7,8,9  11,13,16,17
</code></pre><pre tabindex=0><code>{3,12,14,18,19,15}

     6,   10,    16 
   /   \      \      \
1,2,4,5  7,8,9  11,13  17,20
</code></pre><pre tabindex=0><code>{12,14,18,19,15}

    3,   6,   10,    16 
   /   \    \      \      \
1,2    4,5  7,8,9  11,13  17,20
</code></pre><pre tabindex=0><code>{15}

    3,   6,   10,      16 
   /   \    \       \          \
1,2    4,5  7,8,9  11,12,13,14  17,18,19,20
</code></pre><pre tabindex=0><code>            10
          /      \
    3,   6       13,   16 
   /   \    \      \     \      \
1,2    4,5  7,8,9  11,12  14,15  17,18,19,20
</code></pre><h3 id=b树的删除>B树的删除</h3><p>若删除的是非终端结点（即不是最低的非空结点），可以用前驱或后继代替，从而转化为删除终端结点的情况。</p><p>若删除的是终端结点，</p><ol><li>删除后仍满足关键字个数大于 $\lceil m/2 \rceil-1$，则完成</li><li>反正，则向兄弟结点借，节的过程是：兄弟结点的最大/小值先代替父节点的一个关键字，再将父节点的关键字移到删除结点<pre tabindex=0><code>删除65

   60, 71
 /    |   \
...  65  74,86

   60, 71
 /    |   \
...  空  86

   60, 74
 /    |   \
...  71  86
</code></pre></li><li>若兄弟结点不够借（即关键字都刚好是 $\lceil m/2 \rceil-1$），则将被删结点、父结点中的关键字、兄弟结点组合成新结点（此时为 $m-1$ 个关键字）。删除后，父节点的关键字个数少1，若<ol><li>父节点是根，且减少为0，则新结点成为新的根</li><li></li></ol></li></ol></div></div></main><script src=https://tokinx.github.io/lately/lately.min.js></script>
<script>window.Lately&&Lately.init({target:".post-date"})</script></body></html>