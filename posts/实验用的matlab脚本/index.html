<!doctype html><html lang=en><head><meta charset=utf-8><meta name=renderer content="webkit"><meta http-equiv=x-ua-compatible content="IE=Edge,chrome=1"><meta http-equiv=cache-control content="no-siteapp"><meta http-equiv=cache-control content="no-transform"><meta name=viewport content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name=description content="(Experimental Design)"><link rel="shortcut icon" href=/images/favicon.png><link rel=apple-touch-icon href=/images/favicon.png><meta name=author content="map[]"><title>Todd's Blog | 实验用的matlab脚本</title><link rel=stylesheet href=/css/style.css></head><body class="antialiased bg-primary"><div class="flex flex-col sm:flex-row w-full text-white"><div class="sm:fixed w-screen sm:w-4/12 lg:w-3/12 h-screen p-4 bg-secondary bg-cover bg-center" style=background-image:url(/images/bg.png)><div class="flex flex-col justify-center items-center space-y-3 w-full h-full text-center text-white"><div><img class="w-3/12 sm:w-4/12 h-auto aspect-square m-auto rounded-[50%]" src=/images/avatar.png alt=Todd></div><div><a class="text-3xl font-semibold hover:text-accent" href=/>Todd's Blog</a></div><div class=item-center><p class="text-lg font-medium">(Experimental Design)</p></div><div class=pt-5><ul class=text-3xl><li class="inline-block hover:text-accent"><a class=p-3 href=/><i class="fas fa-envelope"></i></a></li><li class="inline-block hover:text-accent"><a class=p-3 href=/about><i class="fab fa-youtube"></i></a></li><li class="inline-block hover:text-accent"><a class=p-3 href=https://github.com/ToddZZF><i class="fab fa-github"></i></a></li><li class="inline-block hover:text-accent"><a class=p-3 href=/about><i class="fab fa-weixin"></i></a></li></ul></div></div></div><div class="flex flex-col w-screen sm:w-8/12 lg:w-6/12 sm:ml-[33.3%] lg:ml-[25%] p-6 md:p-12 bg-primary"><div class="text-3xl font-semibold">实验用的matlab脚本</div><div class="mb-4 text-base text-[#868E96]">Oct 20, 2021</div><div class="article relative"><p>处理数据中常用的函数和脚本</p><h2 id=清场>清场</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-matlab data-lang=matlab><span style=display:flex><span>close all; clear; clc;
</span></span></code></pre></div><h2 id=读取数据>读取数据</h2><h3 id=xlsx>xlsx</h3><p>需要依赖 Microsoft Excel（无法用 WPS 替代）。可以默认读取整张表格，也可以读取特定数据。下面三个参数分别是：文件名、第几个sheet、范围。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-matlab data-lang=matlab><span style=display:flex><span>[num,txt,raw]=xlsread(<span style=color:#e6db74>&#39;NBTI to华工.xlsx&#39;</span>,<span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>[num,txt,raw]=xlsread(<span style=color:#e6db74>&#39;NBTI to华工.xlsx&#39;</span>,<span style=color:#ae81ff>1</span>,<span style=color:#e6db74>&#39;D8:D23&#39;</span>)
</span></span></code></pre></div><h3 id=csv>csv</h3><p>csv 开头一般会有一些文字信息，而 csvread 只能读取数字，所以需要指定行号：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-matlab data-lang=matlab><span style=display:flex><span>M = csvread(<span style=color:#e6db74>&#39;filename&#39;</span>, row, col)
</span></span><span style=display:flex><span>M = csvread(<span style=color:#e6db74>&#39;filename&#39;</span>, row, col, range)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>% row, col：开始读取的行列，相当于下面的 R1, C1</span>
</span></span><span style=display:flex><span><span style=color:#75715e>% range = [R1 C1 R2 C2]: 读取区域的左上与右下坐标</span>
</span></span></code></pre></div><p>但注意的是，行号和列号都是从 0 开始的（这也太割裂了……）</p><h2 id=数据拟合>数据拟合</h2><p>MATLAB自带的拟合函数：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-matlab data-lang=matlab><span style=display:flex><span><span style=color:#75715e>%多项式拟合</span>
</span></span><span style=display:flex><span>p = polyfit(x,y,n)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>% 参数：x,y 数据；n 多项式次数</span>
</span></span><span style=display:flex><span><span style=color:#75715e>% 返回：多项式系数（高次到低次）</span>
</span></span></code></pre></div><p>一般我们需要同时画出拟合曲线，所以我们可以将这个与画图结合，封装为一个新的函数：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-matlab data-lang=matlab><span style=display:flex><span><span style=color:#66d9ef>function</span> p = <span style=color:#a6e22e>fit_plot</span>(x,y,n)
</span></span><span style=display:flex><span>    p=polyfit(x,y,n);
</span></span><span style=display:flex><span>    x1=linspace(min(x),max(x));
</span></span><span style=display:flex><span>    y1=polyval(p,x1);
</span></span><span style=display:flex><span>    plot(x,y,<span style=color:#e6db74>&#39;*&#39;</span>,x1,y1);
</span></span><span style=display:flex><span>    disp(<span style=color:#e6db74>&#39;系数（高到低）&#39;</span>);
</span></span><span style=display:flex><span>    disp(p);
</span></span></code></pre></div><p>事实上，如果是一元线性拟合，我更推荐直接上线性回归分析：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-matlab data-lang=matlab><span style=display:flex><span>x=[<span style=color:#ae81ff>1</span>,<span style=color:#ae81ff>2</span>,<span style=color:#ae81ff>3</span>,<span style=color:#ae81ff>4</span>,<span style=color:#ae81ff>5</span>];
</span></span><span style=display:flex><span>y=[<span style=color:#ae81ff>1.01</span>,<span style=color:#ae81ff>2.02</span>,<span style=color:#ae81ff>3.03</span>,<span style=color:#ae81ff>3</span>,<span style=color:#ae81ff>5.05</span>];
</span></span><span style=display:flex><span>X=[ones(size(x<span style=color:#f92672>&#39;</span>)),x<span style=color:#f92672>&#39;</span>];
</span></span><span style=display:flex><span>[b,bint,r,rint,stats]=regress(y<span style=color:#f92672>&#39;</span>,X,<span style=color:#ae81ff>0.05</span>); <span style=color:#75715e>%一元回归分析</span>
</span></span><span style=display:flex><span><span style=color:#75715e>% b: 回归方程中的参数估计值</span>
</span></span><span style=display:flex><span><span style=color:#75715e>% bint: b 的置信区间</span>
</span></span><span style=display:flex><span><span style=color:#75715e>% r 和 rint: 分别表示残差及残差对应的置信区间</span>
</span></span><span style=display:flex><span><span style=color:#75715e>% stats: 包含相关系数r^2, F 统计量及 F 对应的概率 p 值</span>
</span></span><span style=display:flex><span>rcoplot(r,rint); <span style=color:#75715e>%在置信区间下误差分析</span>
</span></span></code></pre></div><p>这里同样会给出系数，但注意 b 是从低次到高次。</p></div><hr class=my-6><footer class="text-base text-[#868E96]"><small>&copy; 0001 - 2022 <a href=https://toddzzf.github.io class="underline hover:text-accent">Todd</a>. All rights reserved.
Powered by <a href=https://gohugo.io/ class="underline hover:text-accent">Hugo</a> & <a href=https://github.com/vszhub/not-pure-poole class="underline hover:text-accent">Not Pure Poole</a>.</small></footer></div></div></body><link href=https://cdn.bootcdn.net/ajax/libs/font-awesome/5.15.3/css/all.min.css rel=stylesheet><link href=https://cdn.bootcdn.net/ajax/libs/highlight.js/11.4.0/styles/github-dark-dimmed.min.css rel=stylesheet><script src=https://cdn.bootcdn.net/ajax/libs/highlight.js/11.4.0/highlight.min.js></script>
<script>hljs.highlightAll()</script></html>